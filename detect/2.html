<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>alert detect</title>
</head>
<body>
    <script>
(function() {
  'use strict';

  function checkAlertSupport() {
    return new Promise(resolve => {
      const start = performance.now();
      let blocked = false;

      // 若 100ms 内未阻塞，视为被屏蔽
      const timer = setTimeout(() => {
        resolve(false);
      }, 100);

      try {
        alert('检测中…请关闭此窗口');
        blocked = true; // 只有弹窗关闭后才能执行到这一行
        clearTimeout(timer);
        // 粗略验证阻塞时间，防止某些环境假阻塞
        if (performance.now() - start > 200) {
          resolve(true);
        } else {
          resolve(false);
        }
      } catch (e) {
        clearTimeout(timer);
        resolve(false);
      }
    });
  }

  // 执行检测
  checkAlertSupport().then(supported => {
    if (supported) {
      console.log('[Alert检测] ✅ 支持 alert()');
    } else {
      console.warn('[Alert检测] ❌ alert() 被屏蔽或无效');
      const msg = document.createElement('div');
      msg.id = 'alert-check-result';
      msg.style.cssText = `
        position:fixed;top:0;left:0;width:100%;padding:8px;
        background:#222;color:#fff;text-align:center;font:14px/1.5 sans-serif;
        z-index:2147483647;
      `;
      msg.textContent = supported 
        ? '✓ alert() 正常' 
        : '⚠️ alert() 被屏蔽！建议更换 Chrome/Edge/Firefox';
      document.body.appendChild(msg);

      setTimeout(() => {
        const el = document.getElementById('alert-check-result');
        el && el.remove();
      }, 10000);
    }
  });
})();
</script>
</body>
</html>