(function(){const style=document.createElement('style');style.textContent=`.ios-modal-backdrop{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:9998;opacity:0;transition:opacity 0.3s ease;backdrop-filter:blur(4px)}.ios-modal-container{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);min-width:300px;max-width:520px;background:rgba(255,255,255,0.71);backdrop-filter:blur(12.5px);border-radius:22px;border:1px solid rgba(0,0,0,0.2);z-index:9999;opacity:0;transition:opacity 0.15s ease;box-shadow:0 4px 50px rgba(0,0,0,0.40);overflow:hidden;font-family:'Misa','PingFang SC','HarmonyOS Sans SC',sans-serif}[data-theme="dark"] .ios-modal-container{background:rgba(23,24,26,0.85);border-color:rgba(255,255,255,0.08);box-shadow:0 4px 50px rgba(0,0,0,0.66)}.ios-modal-title{padding:12px 24px 12px;text-align:center;font-weight:600;font-size:18px;color:#dfefffff;position:relative}.ios-modal-title::after{content:'';margin-left:-0.9em;pointer-events:none}.ios-title-spacing-small2{letter-spacing:0em}.ios-title-spacing-small{letter-spacing:0.1em}.ios-title-spacing-medium{letter-spacing:0.7em}.ios-title-spacing-large{letter-spacing:1em}.ios-modal-content{padding:0 24px;margin-top:-8px;font-size:15px;color:#333;max-height:50vh;overflow-y:auto;line-height:1.5}.ios-modal-content p{margin-top:0!important;margin-bottom:8.5px!important}[data-theme="dark"] .ios-modal-content{color:#EEE}.ios-modal-footer{display:flex;border-top:1px solid rgba(0,0,0,0.2);margin-top:0}[data-theme="dark"] .ios-modal-footer{border-top-color:rgba(255,255,255,0.08)}.ios-modal-button{flex:1;padding:12px 10px;text-align:center;font-size:16px;font-weight:600;color:#007AFF;background:none;border:none;cursor:pointer;position:relative;line-height:1.2;outline:none}.ios-modal-button:not(:last-child)::after{content:'';position:absolute;right:0;top:0;height:100%;width:1px;background:rgba(0,0,0,0.2)}[data-theme="dark"] .ios-modal-button:not(:last-child)::after{background:rgba(255,255,255,0.08)}.ios-modal-button::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(120,120,128,0.12);opacity:0;border-radius:0;pointer-events:none;transition:opacity 0.15s ease}[data-theme="dark"]  .ios-modal-button::before{background-color:rgba(120,120,126,0.06)}.ios-modal-button:hover::before{opacity:1}.ios-button-red{color:#FF3B30!important}.ios-button-gray{color:#8E8E93!important}`;document.head.appendChild(style);window.showModal=function(config){const id=config.id||'';const storageKey=`modal_closed_${location.host}_${id}`;if(id){const storedVersion=localStorage.getItem(storageKey);if(!config.forceShow&&storedVersion&&storedVersion>=config.version){return}}const backdrop=document.createElement('div');backdrop.className='ios-modal-backdrop';backdrop.dataset.modalId=id;const container=document.createElement('div');container.className='ios-modal-container';container.dataset.modalId=id;const currentTheme=document.documentElement.getAttribute('data-theme')||'light';const title=document.createElement('div');title.className='ios-modal-title';title.textContent=config.title||'公告';const titleLength=title.textContent.length;if(titleLength<=2){title.classList.add('ios-title-spacing-large')}else if(titleLength===3){title.classList.add('ios-title-spacing-medium')}else if(titleLength===4){title.classList.add('ios-title-spacing-small')}else{title.classList.add('ios-title-spacing-small2')}if(config.titleColor==='white'){title.style.color=currentTheme==='dark'?'#FFFFFF':'#000000'}else{title.style.color='#007AFF'}const content=document.createElement('div');content.className='ios-modal-content';content.innerHTML=config.content;const footer=document.createElement('div');footer.className='ios-modal-footer';config.buttons.forEach(btn=>{const button=document.createElement('button');const colorClass=btn.style?`ios-button-${btn.style}`:'';button.className=`ios-modal-button ${colorClass}`.trim();button.textContent=btn.text;const modalId=id;button.onclick=function(){if(btn.action==='close'){handleButtonAction(btn.action,btn.url,config.id,config.version,modalId)}else{executeButtonAction(btn.action,btn.url)}};footer.appendChild(button)});container.appendChild(title);container.appendChild(content);container.appendChild(footer);document.body.appendChild(backdrop);document.body.appendChild(container);setTimeout(()=>{backdrop.style.opacity='1';container.style.opacity='1'},10)};function handleButtonAction(action,url,id,version,modalId){if(id){const storageKey=`modal_closed_${location.host}_${id}`;localStorage.setItem(storageKey,version)}closeModalById(modalId)}function executeButtonAction(action,url){if(action==='go_home'){try{window.close();setTimeout(()=>{if(!window.closed){window.location.href='about:blank'}},1000)}catch(e){window.location.href='about:blank'}}else if(action==='open_link'){window.open(url,'_blank')}}function closeModalById(modalId){const containers=Array.from(document.querySelectorAll('.ios-modal-container')).filter(el=>el.dataset.modalId===(modalId||''));if(containers.length===0){console.warn(`[modal]No active modal found with id="${modalId}"`);return}const container=containers[containers.length-1];const backdrop=container.previousElementSibling;if(!backdrop||!backdrop.classList.contains('ios-modal-backdrop')){console.error(`[modal]Backdrop not found for container with id="${modalId}"`);return}container.style.opacity='0';backdrop.style.opacity='0';setTimeout(()=>{if(backdrop.parentNode){document.body.removeChild(backdrop)}if(container.parentNode){document.body.removeChild(container)}},300)}window.closeModalById=closeModalById})();